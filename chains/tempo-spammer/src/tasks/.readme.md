# Tasks Directory

This directory contains the task implementations (`tXX_taskname.rs`) and their corresponding documentation (`tXX.md`).

## üõ†Ô∏è Developer Guidelines

1.  **Do Not Break Existing Tasks**: Ensure changes in shared logic (like `core-logic` or `utils`) do not break other tasks. Run `cargo check` frequently.
2.  **Fire and Forget**: Tasks should generally not block on transaction confirmation. Once the transaction hash is obtained (entered mempool), return success.
3.  **Documentation**: Every `.rs` implementation must have a matching `.md` file explaining the workflow, inputs, and expected outputs.
4.  **Zero Warnings**: When a task is marked as complete, ensure it compiles and runs with **zero warnings**. Clean up unused imports and variables.
5.  **Update Task MD**: Upon task completion, update the corresponding `tXX.md` file to reflect the final implementation details and accurate debugging instructions.

## üêõ Debugging

# Syntax: cargo run --bin debug_task -- --task <ID> --wallet <INDEX>
cargo run --bin tempo-debug -- --task 39

1.  **System Tokens**: Pre-deployed stablecoins managed by the network configuration. Used for base pairs and initial testing.
2.  **Created Stablecoins**: New stablecoins deployed dynamically by **Task 04**. These simulate user-created pegged assets.
3.  **Created Memecoins**: Speculative tokens deployed dynamically by **Task 21**. Used for high-volume transfer and swap testing.

## üèõÔ∏è System Tokens

The following tokens are hardcoded into the pre-genesis state and are always available:

| Name     | Symbol     | Address                                      |
| :---     | :---       | :---                                         |
| PathUSD  | `PathUSD`  | `0x20C0000000000000000000000000000000000000` |
| AlphaUSD | `AlphaUSD` | `0x20c0000000000000000000000000000000000001` |
| BetaUSD  | `BetaUSD`  | `0x20c0000000000000000000000000000000000002` |
| ThetaUSD | `ThetaUSD` | `0x20c0000000000000000000000000000000000003` |

## üìö References

When developing a new task or porting logic, refer to these resources:

*   **Logic Implementation**: `chains/tempo/_reference-nodejs DONOT USE THIS FOLDER`
    *   Contains the original Node.js scripts. Use this as the **primary source of truth** for task logic (inputs, outputs, steps).
*   **Context & Docs**: `chains/tempo/docs`
    *   Contains general documentation about the Tempo chain and environment.

## üìÇ Tempo Folder Structure

Understanding the layout of `chains/tempo/src` helps in finding reusable components:

*   **`bin/`**: Entry points for binaries.
    *   `tempo-project.rs`: The main Spammer Swarm application.
    *   `debug_task.rs`: The interactive debugger CLI.
*   **`tasks/`**: Individual task implementations (`tXX_name.rs`) and their documentation (`tXX.md`).
*   **`utils/`**: Shared helper modules.
    *   `contract_compiler.rs`: Compiles Solidity contracts on the fly.
    *   `gas_manager.rs`: Handles gas estimation and priority fees.
    *   `multicall.rs`: Helper for batching calls via Multicall3.
    *   `nonce_manager.rs`: Manages transaction nonces locally.
    *   `address_reader.rs`: Random address selection from `address.txt`.

## üöÄ Transaction Batching Methods (6 Total)

The framework supports **6 batching strategies**. The two **Tempo-specific** methods are prioritized as they leverage protocol-level features.

1. **Tempo Native Batch**: Atomic multi-op transactions (e.g. Create + Grant + Mint)
2. **Tempo 2D Nonces**: High-throughput parallel payments
3. **Multicall3 Aggregation**: ERC20 transfers to many recipients
4. **Concurrent Async**: Fast native ETH distribution
5. **Sequential Loop**: Reliable and ordered operations (e.g. Swaps)
6. **Optimistic Pipelining**: Delayed dependency burst (Deploy -> Fund -> Use)

| # | Batching Method | Type | Best For | Status |
| :--- | :--- | :--- | :--- | :--- |
| **1** | **Tempo Native Batch** | **Tempo Feature** | Atomic multi-op transactions (e.g. Create + Grant + Mint) | ‚úÖ Implemented (Task 4) |
| **2** | **Tempo 2D Nonces** | **Tempo Feature** | High-throughput parallel payments | ‚ùå Planned |
| 3 | Multicall3 Aggregation | Standard EVM | ERC20 transfers to many recipients | ‚úÖ Implemented |
| 4 | Concurrent Async | Standard EVM | High-volume native ETH transfers | ‚úÖ Implemented |
| 5 | Sequential Loop | Standard EVM | Critical ordered operations (e.g. Swaps) | ‚úÖ Implemented |
| 6 | Optimistic Pipelined| Mixed | Sequential dependencies without waiting | ‚úÖ Implemented (T40-42) |

---

### 1. Tempo Native Batch Transactions (‚úÖ Implemented)
**Best for**: Atomic multi-operation transactions.
**How it works**: Built directly into `TempoTransaction`. Single signature, atomic execution of multiple calls.
**Used in**: Task 04 (Create Stable).

### 2. Tempo 2D Nonce System (‚ùå Planned)
**Best for**: True parallel payments.
**How it works**: Uses `nonceKey` (2D nonces) to allow independent transaction sequences from the same sender.
**Status**: Requires primitives crate integration.

### 3. Multicall3 Aggregation (‚úÖ Implemented)
**Best for**: Gas-efficient ERC20 transfers.
**How it works**: Uses canonical Multicall3 contract to bundle calls.
**Used in**: Task 28, 29, 30.

### 4. Concurrent Async Sending (‚úÖ Implemented)
**Best for**: Fast native ETH distribution.
**How it works**: Fires multiple futures in parallel. Provider manages nonce sequence.
**Used in**: Task 31, 32, 33.

### 5. Sequential Loop (‚úÖ Implemented)
**Best for**: Reliability and ordering.
**How it works**: One-by-one execution, waiting for confirmations.
**Used in**: Task 24, 25, 26.

### 6. Optimistic Pipelining (‚úÖ Implemented)
**Best for**: Complex workflows with dependencies (e.g., Deploying a contract, then funding it, then using it).
**How it works**: 
1. Predict the deployment address (using wallet address + start nonce).
2. Construct all transactions with sequential nonces (N, N+1, N+2).
3. Send all transactions simultaneously via `tokio::join!`.
4. The network naturally orders them by nonce, resulting in near-instant completion of multi-step processes.
**Used in**: Task 40, 41, 42.

